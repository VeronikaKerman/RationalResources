Profile
{
	name = KerbalismSupport
	modname = Rational Resources Kerbalism
	moddir = RationalResourcesKerbalism
	
	// Setup status alerts
	Supply
	{
		resource = Hydrates
		low_message = Hydrates is almost depleted on $VESSEL@<i>Hydrate sifting will soon be unavailable</i>
		empty_message = There is no more Hydrates on $VESSEL@<i>Hydrate sifting is no longer available</i>
		refill_message = $VESSEL Hydrates storage refilled@<i>Hydrate sifting is available</i>
	}
	Supply
	{
		resource = LqdDeuterium
		low_message = LqdDeuterium is almost depleted on $VESSEL@<i>Fusion fuel processes will soon be unavailable</i>
		empty_message = There is no more LqdDeuterium on $VESSEL@<i>Fusion fuel processes are no longer available</i>
		refill_message = $VESSEL LqdDeuterium storage refilled@<i>Fusion fuel processes are available</i>
	}
	Supply
	{
		resource = LqdHe3
		low_message = LqdHe3 is almost depleted on $VESSEL@<i>Fusion fuel processes will soon be unavailable</i>
		empty_message = There is no more LqdHe3 on $VESSEL@<i>Fusion fuel processes are no longer available</i>
		refill_message = $VESSEL LqdHe3 storage refilled@<i>Fusion fuel processes are available</i>
	}
	Supply
	{
		resource = Rock
		low_message = Rock is almost depleted on $VESSEL@<i>Molten Regolith alternative processing will soon be unavailable</i>
		empty_message = There is no more Rock on $VESSEL@<i>Molten Regolith alternative processing is no longer available</i>
		refill_message = $VESSEL Rock storage refilled@<i>Molten Regolith alternative processing is available</i>
	}
	Supply
	{
		resource = Spodumene
		low_message = Spodumene is almost depleted on $VESSEL@<i>Lithium sifting will soon be unavailable</i>
		empty_message = There is no more Spodumene on $VESSEL@<i>Lithium sifting is no longer available</i>
		refill_message = $VESSEL Spodumene storage refilled@<i>Lithium sifting is available</i>
	}
	
	
	// Define ISRU chains used by process controllers
	
	// Balance recipes to use no more than 80 kW
	// and have mass flow less than 5 kg/min
	// Kerbalism has 1/36 recipes of this.
	
	// - Standard converters
	// there should be metal as a output
	// and electricity consumption around that of: Alumina el, Metals smelter, Silicone el.
	// todo: The optimized models predict that a 400 kg, 14 kW MRE-based ISRU system can produce 1,000 kg oxygen per year from lunar Highlands regolith. A 1593 kg, 56.5 kW system can produce 10,000 kg oxygen per year.
	Process
	{
		name = MRE-Rock
		title = Molten Regolith Electrolysis (Rock)
		Tag = Sabe
		modifier = _MRER
		// If this was Alumina recipe, the usage would be 0.7 ec
		input = ElectricCharge@76
		input = Rock@0.0285
		output = Oxygen@17.7686
		output = CarbonDioxide@0.88843
		output = Shielding@0.0000224
		dump_valve = Shielding&CarbonDioxide,Shielding,Shielding&Oxygen,CarbonDioxide,Oxygen,CarbonDioxide&Oxygen
	}
	Process
	{
		// Not a duplicate, because Kerbalism recipe uses Oxidizer (HTP?).
		// Same EC/Mono as kerbalism. This recipe is magic anyway.
		name = AmmoniatoMonoPropellant
		title = Ammonia to MonoPropellant
		Tag = RR
		modifier = _AmmoniaToMono
		input = ElectricCharge@1.194
		input = LqdAmmonia@0.4851 // 341g
		output = MonoPropellant@0.0427
		output = LqdHydrogen@0.2845
		dump_valve = MonoPropellant,LqdHydrogen
	}
	Process
	{
		// Glykerol is magic (not glucose), so roughly just boil the water.
		name = GlykerolBrewer
		title = Glykerol Brewer
		Tag = RR
		modifier = _GlykerolBrew
		input = ElectricCharge@4
		input = Water@0.004347008  // 4.35 g
		input = Carbon@0.001035088 // 2.17 g
		output = Glykerol@0.000462963 // 5.56g, 3 hours per freeze
		output = Oxygen@0.684494376// 0.97 g
		dump_valve = Oxygen
	}
	Process
	{
		// Magic process. Pretnds it is baking the carbon to 530C
		name = CarbonExtractor
		title = Carbon Extractor
		Tag = RR
		modifier = _CarbonExtractor
		input = ElectricCharge@24
		input = Ore@0.01803    // 180  g
		output = Carbon@0.03603 // 75.6g
	}
	// Very cheap process as the reaction is exothermic burning
	Process
	{
		name = CarbonFuser
		title = Carbon Fuser
		Tag = RR
		modifier = _CarbonFuser
		input = ElectricCharge@0.00714
		input = Carbon@0.020808
		input =         Oxygen@19.67659968 // 116.42 g
		output = CarbonDioxide@82.06756256 // 160.11 g
	}
	// Process
	// {
		// name = LeadExtractor
		// title = KerbalHealth Lead Extractor
		// Tag = RR
		// modifier = _LeadExtractor
		// input = ElectricCharge@0.0042
		// input = MetalOre@0.03921830769
		// output = Lead@0.00899185185
	// }
	// Process
	// {
		// name = AluminaSplitter // Original
		// title = Alumina Splitter
		// Tag = RR
		// modifier = _SplitterAl2O3
		// input = ElectricCharge@0.0042
		// input = Alumina@0.2562
		// output = Metal@0.1002
		// output = Oxygen@113.4752
		// dump_valve = Metal,Oxygen
	// }
	// heating and enthalpy:  9497.82 kJ / 539.6g
	// industrial electroly: 25591.11 kJ / 539.6g
	// (handwaving the carbon electrode consumption)
	// https://www.sciencedirect.com/topics/engineering/aluminum-production
	Process
	{
		name = AluminaSplitter
		title = Alumina Splitter
		Tag = RR
		modifier = _SplitterAl2O3
		input = ElectricCharge@76.5
		input = Alumina@0.001461
		output = Oxygen@2.55319125
		output = Aluminium@0.001921349 // 1.46 g
		dump_valve = Aluminium,Oxygen
	}
	Process
	{
		// Solid Oxide electrolysis should make CO, not C
		// ignore for now
		name = CarbonDioxideSplitter
		title = Carbon Dioxide Splitter
		Tag = RR
		modifier = _SplitterCO2
		input = ElectricCharge@0.0042
		input = CarbonDioxide@22.5818
		output = Oxygen@22.69504
		output = Carbon@0.024
		dump_valve = Carbon,Oxygen
	}
	Process
	{
		// ignore for now
		name = CarbonMonoxideA
		title = Carbon Monoxide A
		Tag = RR
		modifier = _CarbonMonoA
		input = ElectricCharge@0.0042
		input = CarbonDioxide@2255.7663
		output = Oxygen@22.69504
		output = CarbonMonoxide@2240.8
		dump_valve = Oxygen
	}
	Process
	{
		// ignore for now
		name = CarbonMonoxideB
		title = Carbon Monoxide B
		Tag = RR
		modifier = _CarbonMonoB
		input = ElectricCharge@0.0042
		input = Carbon@0.5719
		input = Water@1.8020
		output = CarbonMonoxide@2240.8
		output = Hydrogen@2246.941
		dump_valve = CarbonMonoxide,Hydrogen
	}
	Process
	{
		// For energy calculation, it is 50% water, 50% Fe2O3, heated to 530 C, and the water boiled.
		// For decomposition, assume 46.23% water, 46.35% Fe2O3
		//     6.55 trapped Oxygen, 0.32% Xenon and 0.35% Argon by weight.
		name = HydratesSplitter
		title = Hydrates Splitter
		Tag = RR
		modifier = _SplitterHydrates
		input = ElectricCharge@74.2
		input = Hydrates@0.021098
		output = Water@0.01463
		output = XenonGas@0.001008
		output = ArgonGas@0.062699
		output = MetallicOre@0.0026698
		output = Oxygen@1.47
		dump_valve = XenonGas&ArgonGas&MetallicOre&Oxygen,Water&XenonGas&ArgonGas&MetallicOre,XenonGas&ArgonGas&MetallicOre,Water&ArgonGas&MetallicOre&Oxygen,Water&XenonGas&MetallicOre&Oxygen,Water&XenonGas&ArgonGas&Oxygen
	}
	Process
	{
		// This feels weird.
		name = MonaziteSplitter
		title = Monazite Splitter
		Tag = RR
		modifier = _SplitterMona
		input = ElectricCharge@50.08
		input = Monazite@0.0001872  //936mg
		output = RareMetals@0.0001  //784mg
		output = Phosphorus@0.0000248
		output = Oxygen@0.09078
		dump_valve = RareMetals,Phosphorus,Oxygen,RareMetals&Phosphorus,RareMetals&Oxygen,Phosphorus&Oxygen
	}
	Process
	{
		// Unrealistic recipe. 30% energy usage than alumina splitter.
		name = SilicatesSplitter
		title = Silicates Splitter
		Tag = RR
		modifier = _SplitterSilica
		input = ElectricCharge@42
		input = Silicates@0.0007308 // 1.824g
		output = Silicon@0.0002892 // 672mg
		output = Oxygen@0.8170212
		dump_valve = Silicon,Oxygen
	}
	Process
	{
		name = SpodumeneSplitter
		title = Spodumene Splitter
		Tag = RR
		modifier = _SplitterSpod
		input = ElectricCharge@60
		input = Spodumene@0.0018    // 5.58g
		output = Lithium@0.00039    // 207mg/s
		output = Aluminium@0.00291  // 807mg/s
		output = Silicates@0.0001827// 457mg/s
		dump_valve = Aluminium,Aluminium&Lithium,Aluminium&Silicates,Lithium,Lithium&Silicates,Silicates
	}
	Process
	{
		// Ideal electrolysis: 141.86 MJ/kg(H2) -> 28526 EC / 201g
		// Kerbalism is uses about 5.3 times less electricity
		name = WaterSplitter
		title =  Water Splitter
		Tag = RR
		modifier = _SplitterH2O
		input = ElectricCharge@77.031
		input = Water@0.00486 // 4.86g/s
		output = Hydrogen@6.0392979 // 543mg/s
		output = Oxygen@3.060882
		output = Deuterium@0.004698
		dump_valve = Hydrogen,Oxygen,Deuterium,Hydrogen&Oxygen,Deuterium&Oxygen,Hydrogen&Deuterium
	}
	Process
	{
		name = ECHeatedMetalSmelter
		title = Metals Smelter
		Tag = RR
		modifier = _ECHeatedMetalSmelter
		input = ElectricCharge@76.5
		input =   MetallicOre@0.01462
		input =     Hydrogen@30.48678
		output =       Metals@0.0064889
		output =        Water@0.0230316
		dump_valve = Water
		// 90% of ore converted to Metals
		//  5% of mass is lost to space
		//  5% of ore was water
	}
	Process
	{
		// It is exothermic process, so the power usage is a guess.
		// 4.6 kg/min for 2 kW
		name = SabatierProcessRR
		title = Sabatier Process RR
		modifier = _SabatierRR
		input = ElectricCharge@75
		input = CarbonDioxide@4.0603793
		input =      Hydrogen@16.177976
		output =      Methane@4.0267782
		output =       Water@0.00648720
		dump_valve = Water,Methane
	}
	Process
	{
		// Heating to 530c : 17.85 kJ
		// Endothermic reac: 18.85 kJ
		// https://pubs.acs.org/doi/10.1021/acs.iecr.1c01679
		name = MethanePyrolysis
		title = Methane Pyrolysis
		modifier = _SplitterMethane
		input = ElectricCharge@76.46
		input = Methane@18.344212 // 13.15g
		output = Carbon@0.0046896 //  9.85g
		output = Hydrogen@36.849833 //3.31g
		dump_valve = Carbon,Hydrogen
	}
	
	// - Compressor/Freezer converters
	Process
	{
		name = FreezeAmmonia
		title = Freeze Ammonia
		Tag = RR
		modifier = _FreezeNH3
		input = ElectricCharge@0.0028
		input = Ammonia@221.47
		output = LqdAmmonia@0.24
	}
	Process
	{
		name = FreezeCarbonDioxide
		title = Freeze CarbonDioxide
		Tag = RR
		modifier = _FreezeCO2
		input = ElectricCharge@0.0028
		input = CarbonDioxide@225.58
		output = LqdCO2@0.38
	}
	Process
	{
		name = FreezeCarbonMonoxide
		title = Freeze CarbonMonoxide
		Tag = RR
		modifier = _FreezeCO
		input = ElectricCharge@0.0028
		input = CarbonMonoxide@224.08
		output = LqdCO@0.3546
	}
	Process
	{
		name = FreezeDeuterium
		title = Freeze Deuterium
		Tag = RR
		modifier = _FreezeD
		input = ElectricCharge@0.0028
		input = Deuterium@270.6
		output = LqdDeuterium@0.3
	}
	Process
	{
		name = FreezeHydrogen
		title = Freeze Hydrogen
		Tag = RR
		modifier = _FreezeH2
		input = ElectricCharge@0.0028
		input = Hydrogen@224.25
		output = LqdHydrogen@0.28
	}
	Process
	{
		name = FreezeMethane
		title = Freeze Methane
		Tag = RR
		modifier = _FreezeCH4
		input = ElectricCharge@0.0028
		input = Methane@223.88
		output = LqdMethane@0.38
	}
	Process
	{
		name = FreezeNitrogen
		title = Freeze Nitrogen
		Tag = RR
		modifier = _FreezeN2
		input = ElectricCharge@0.0028
		input = Nitrogen@223.93
		output = LqdNitrogen@0.34
	}
	Process
	{
		name = FreezeOxygen
		title = Freeze Oxygen
		Tag = RR
		modifier = _FreezeO2
		input = ElectricCharge@0.0028
		input = Oxygen@226.95
		output = LqdOxygen@0.28
	}
	Process
	{
		name = FreezeOxidizer
		title = Freeze Oxidizer
		Tag = RR
		modifier = _FreezeOxi
		input = ElectricCharge@0.0028
		input = Oxygen@226.96
		output = Oxidizer@0.064
	}
	
	// - Decompressor/Heater converters
	Process
	{
		name = ThawAmmonia
		title = Thaw Ammonia
		Tag = RR
		modifier = _ThawNH3
		input = ElectricCharge@0.0021
		input = LqdAmmonia@0.24
		output = Ammonia@221.47
	}
	Process
	{
		name = ThawCarbonDioxide
		title = Thaw CarbonDioxide
		Tag = RR
		modifier = _ThawCO2
		input = ElectricCharge@0.0021
		input = LqdCO2@0.38
		output = CarbonDioxide@225.58
	}
	Process
	{
		name = ThawCarbonMonoxide
		title = Thaw CarbonMonoxide
		Tag = RR
		modifier = _ThawCO
		input = ElectricCharge@0.0021
		input = LqdCO@0.3546
		output = CarbonMonoxide@224.08
	}
	Process
	{
		name = ThawHydrogen
		title = Thaw Hydrogen
		Tag = RR
		modifier = _ThawH2
		input = ElectricCharge@0.0021
		input = LqdHydrogen@0.28
		output = Hydrogen@224.25
	}
	Process
	{
		name = ThawMethane
		title = Thaw Methane
		Tag = RR
		modifier = _ThawCH4
		input = ElectricCharge@0.0021
		input = LqdMethane@0.38
		output = Methane@223.88
	}
	Process
	{
		name = ThawNitrogen
		title = Thaw Nitrogen
		Tag = RR
		modifier = _ThawN2
		input = ElectricCharge@0.0021
		input = LqdNitrogen@0.34
		output = Nitrogen@223.93
	}
	Process
	{
		name = ThawOxygen
		title = Thaw Oxygen
		Tag = RR
		modifier = _ThawO2
		input = ElectricCharge@0.0021
		input = LqdOxygen@0.28
		output = Oxygen@226.95
	}
}

// Define pseudo-resources used by proccess controllers

// Default Bulk
RESOURCE_DEFINITION
{
	name = _MRER
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _AmmoniaToMono
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _GlykerolBrew
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _LeadExtractor
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _CarbonExtractor
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _CarbonFuser
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _CarbonMonoA
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _CarbonMonoB
	density = 0.0
	isVisible = false
}

// Default Splitters
RESOURCE_DEFINITION
{
	name = _SplitterAl2O3
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _SplitterCO2
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _SplitterH2O
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _SplitterHydrates
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _SplitterMona
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _SplitterSilica
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _SplitterSpod
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _ECHeatedMetalSmelter
	density = 0.0
	isVisible = false
}

// Default Freezers
RESOURCE_DEFINITION
{
	name = _FreezeCH4
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _FreezeCO
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _FreezeCO2
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _FreezeD
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _FreezeH2
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _FreezeN2
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _FreezeNH3
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _FreezeO2
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _FreezeOxi
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _ThawCH4
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _ThawCO
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _ThawCO2
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _ThawH2
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _ThawN2
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _ThawNH3
	density = 0.0
	isVisible = false
}
RESOURCE_DEFINITION
{
	name = _ThawO2
	density = 0.0
	isVisible = false
}
